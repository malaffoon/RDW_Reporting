package org.opentestsystem.rdw.reporting.processor.web;

import org.opentestsystem.rdw.reporting.processor.model.AbstractExamReportRequest;
import org.opentestsystem.rdw.reporting.processor.model.Report;

import java.util.List;
import java.util.stream.Collectors;

/**
 * Assembler for converting {@link Report} instances to {@link ReportResource} instances.
 */
public class ReportResourceAssembler {

    public ReportResource toResource(final Report report) {
        final ReportResource resource = new ReportResource();
        resource.setId(report.getId());
        resource.setStatus(report.getStatus());
        resource.setLabel(report.getLabel());
        resource.setCreated(report.getCreated());
        resource.setMetadata(report.getMetadata());

        final AbstractExamReportRequest<?> request = report.getReportRequest();
        if (request != null) {
            resource.setRequest(request);
            resource.setReportType(request.getReportType());
            resource.setAssessmentType(request.getAssessmentType() == null ? null : request.getAssessmentType().getAssessmentType());
            resource.setSubject(request.getSubject());
            resource.setSchoolYear(request.getSchoolYear());
        }

        return resource;
    }

    public List<ReportResource> toResources(final List<Report> reports) {
        return reports.stream()
                .map(this::toResource)
                .collect(Collectors.toList());
    }
}

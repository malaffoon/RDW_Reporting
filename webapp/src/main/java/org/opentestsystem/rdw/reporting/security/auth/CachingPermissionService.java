package org.opentestsystem.rdw.reporting.security.auth;

import org.opentestsystem.rdw.security.service.PermissionService;
import org.opentestsystem.rdw.security.service.PermissionServiceException;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.cache.annotation.Cacheable;
import org.springframework.stereotype.Service;

import java.util.Collection;
import java.util.Map;

@Service
public class CachingPermissionService implements PermissionService {

    private PermissionService permissionService;

    @Autowired
    public CachingPermissionService(@Qualifier("defaultPermissionService") final PermissionService permissionService) {
        this.permissionService = permissionService;
    }

    @Cacheable(value = "permissionsByRole")
    public Map<String, Collection<String>> getPermissionsByRole() throws PermissionServiceException {
        return permissionService.getPermissionsByRole();
    }

}


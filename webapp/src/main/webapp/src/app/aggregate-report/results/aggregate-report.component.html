<h2 class="h3 blue-dark">{{report.label}}</h2>

<div class="row mb-sm">
  <div class="col-md-12">
    <button class="btn btn-default btn-sm" (click)="onUpdateRequestButtonClick()">
      <i class="fa fa-chevron-left mr-xs"></i>{{'aggregate-report.form-link' | translate}}
    </button>
  </div>
</div>
<div class="row">
  <div class="col-md-12">
    <ng-container *ngIf="reportProcessing">
      <spinner text="{{'aggregate-report.processing' | translate}}"></spinner>
    </ng-container>

    <ng-container *ngIf="reportNotLoadable">
      <div class="well">
        <p>{{'aggregate-report.error.unloadable' | translate}}</p>
        <button class="btn btn-primary" [routerLink]="['/reports']">{{'aggregate-report.reports-link' | translate}}</button>
      </div>
    </ng-container>

    <ng-container *ngIf="reportSizeNotSupported">
      <div class="well">
        <p>{{'aggregate-report.error.unsupported-size' | translate}}</p>
        <div>
          <button class="btn btn-danger btn-sm" (click)="onDisplayReportButtonClick()">{{'aggregate-report.display-report' | translate}}</button>
          <button class="btn btn-default btn-sm" (click)="onDownloadDataButtonClick()">{{'aggregate-report.download-data' | translate}}</button>
        </div>
      </div>
    </ng-container>

    <ng-container *ngIf="reportView">

      <div class="mb-sm">
        <ng-container *ngTemplateOutlet="updateRequestButton"></ng-container>
      </div>

      <div *ngFor="let table of reportTables" class="well wide-content-container">

        <h3 class="h3 label-group green">
          <span class="label">{{'common.assessment-type.' + query.assessmentTypeCode + '.short-name' | translate}}</span><span class="label">{{'common.subject.' + table.subjectCode + '.short-name' | translate}}</span>
        </h3>

        <div class="mt-xs">
          <aggregate-report-table [table]="table.table"
                                  [valueDisplayType]="query.valueDisplayType"
                                  [performanceLevelDisplayType]="query.achievementLevelDisplayType"
                                  [columnOrdering]="['organization', 'assessmentGrade', 'schoolYear', 'dimension']"></aggregate-report-table>
        </div>
      </div>
    </ng-container>
  </div>
</div>


package org.opentestsystem.rdw.olap.repository;

import org.opentestsystem.rdw.reporting.common.model.AggregateReport;
import org.opentestsystem.rdw.reporting.common.model.ReportQuery;
import org.opentestsystem.rdw.reporting.common.model.ReportRow;
import org.opentestsystem.rdw.reporting.common.security.PermissionSource;

import javax.validation.constraints.NotNull;

/**
 * Repository responsible for the custom aggregate report
 */
public interface CustomAggregateReportRepository {
    /**
     * Creates a custom aggregate report for the given {@link ReportQuery}
     *
     * @param permissionSource the security information to prepare the SQL query parameters for
     * @param query            the {@link ReportQuery} for the report
     * @return a list of {@link ReportRow}s
     */
    AggregateReport findByQuery(@NotNull PermissionSource permissionSource, @NotNull ReportQuery query);

    /**
     * Estimates number of the rows in a custom aggregate report for the given {@link ReportQuery}
     *
     * @param query the {@link ReportQuery} for the report
     * @return an estimated number of rows
     */
    int estimateReportRowCount(@NotNull ReportQuery query);
}
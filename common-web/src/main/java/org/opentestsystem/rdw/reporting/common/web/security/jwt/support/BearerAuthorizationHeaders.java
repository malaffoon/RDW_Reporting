package org.opentestsystem.rdw.reporting.common.web.security.jwt.support;

/**
 * Holds utility methods for dealing with "Authentication: Bearer {token}" HTTP headers
 */
public final class BearerAuthorizationHeaders {

    public static final String AuthorizationTypeHeaderPrefix = "Bearer ";

    private BearerAuthorizationHeaders(){}

    public static void checkIsValid(final String value) {
        if (!isValid(value)) {
            throw new RuntimeException("Invalid Bearer Authorization header. Expected format \"Bearer {token}\"");
        }
    }

    public static boolean isValid(final String value) {
        return value != null && value.startsWith(AuthorizationTypeHeaderPrefix);
    }

    public static String getToken(final String value) {
        return value.substring(AuthorizationTypeHeaderPrefix.length());
    }

    public static String create(final String credentials) {
        return AuthorizationTypeHeaderPrefix + credentials;
    }

}

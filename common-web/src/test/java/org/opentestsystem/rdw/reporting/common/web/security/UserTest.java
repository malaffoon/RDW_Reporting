package org.opentestsystem.rdw.reporting.common.web.security;

import org.junit.Test;

import static org.assertj.core.api.Assertions.assertThat;

public class UserTest {

    @Test
    public void itShouldHaveBuilderValues() {
        final User user = User.builderExt()
                .id("id")
                .username("username")
                .password("password")
                .accountNonExpired(true)
                .accountNonLocked(true)
                .credentialsNonExpired(true)
                .enabled(true)
                .build();
        assertThat(user.getId()).isEqualTo("id");
        assertThat(user.getUsername()).isEqualTo("username");
        assertThat(user.getPassword()).isEqualTo("password");
        assertThat(user.isAccountNonExpired()).isTrue();
        assertThat(user.isAccountNonLocked()).isTrue();
        assertThat(user.isCredentialsNonExpired()).isTrue();
        assertThat(user.isEnabled()).isTrue();
    }

    @Test(expected = NullPointerException.class)
    public void itShouldHaveAnId() {
        User.builderExt()
                .username("username")
                .password("password")
                .build();
    }
}

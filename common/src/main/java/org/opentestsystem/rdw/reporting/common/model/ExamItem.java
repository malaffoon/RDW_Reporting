package org.opentestsystem.rdw.reporting.common.model;

/**
 * Represents an exam item
 */
public class ExamItem {

    private long examId;
    private long itemId;
    private Integer points;
    private int position;
    private String response;
    private WritingTraitScores writingTraitScores;

    private ExamItem(){
    }

    /**
     * @return the exam's entity ID
     */
    public long getExamId() {
        return examId;
    }

    /**
     * @return the assessment item's entity ID
     */
    public long getItemId() {
        return itemId;
    }

    /**
     * @return the points earned on the item or <code>null</code> if the item was not scored
     */
    public Integer getPoints() {
        return points;
    }

    /**
     * @return the item number as it appeared in the exam. This also corresponds to the order the item appeared in.
     */
    public int getPosition() {
        return position;
    }

    /**
     * @return The student-entered response
     */
    public String getResponse() {
        return response;
    }

    /**
     * Returns the (legacy) writing trait scores for this item. Currently, only WER items have
     * writing trait scores associated with them, so this will be <code>null</code> for most items.
     *
     * @return writing trait scores for this item, or null
     */
    public WritingTraitScores getWritingTraitScores() {
        return writingTraitScores;
    }

    public static Builder builder() {
        return new Builder();
    }

    public static class Builder {

        private long examId;
        private long itemId;
        private Integer points;
        private int position;
        private String response;
        private Integer evidenceTraitScore;
        private Integer organizationTraitScore;
        private Integer conventionsTraitScore;

        public Builder examId(final long examId) {
            this.examId = examId;
            return this;
        }

        public Builder itemId(final long itemId) {
            this.itemId = itemId;
            return this;
        }

        public Builder points(final Integer points) {
            this.points = points;
            return this;
        }

        public Builder position(final int position) {
            this.position = position;
            return this;
        }

        public Builder response(final String response) {
            this.response = response;
            return this;
        }

        public Builder writingTraitScores(final Integer evidence, final Integer organization, final Integer conventions) {
            this.evidenceTraitScore = evidence;
            this.organizationTraitScore = organization;
            this.conventionsTraitScore = conventions;
            return this;
        }

        public ExamItem build() {
            final ExamItem score = new ExamItem();
            score.examId = examId;
            score.itemId = itemId;
            score.points = points;
            score.position = position;
            score.response = response;

            if (evidenceTraitScore != null || organizationTraitScore != null || conventionsTraitScore != null) {
                score.writingTraitScores = new WritingTraitScores(evidenceTraitScore, organizationTraitScore, conventionsTraitScore);
            }

            return score;
        }

    }

}
